# MNIST手写数字识别实验总结

## 一、实验目的

本次实验旨在使用Keras框架构建卷积神经网络（CNN），实现对MNIST手写数字数据集的识别和分类，并通过实验了解深度学习中卷积神经网络的基本结构、工作原理以及训练过程。

## 二、数据集介绍

MNIST数据集是机器学习领域中经典的手写数字识别数据集，包含：
- 训练集：60,000张28×28像素的灰度图像
- 测试集：10,000张28×28像素的灰度图像
- 图像内容：0-9的手写数字
- 数据格式：idx文件格式（通过gzip压缩）

本次实验直接使用本地已有的MNIST数据集（位于`./mnist/MNIST/raw`目录），避免了重复下载，提高了实验效率。

## 三、网络架构设计

本实验构建的卷积神经网络模型具有以下结构：

1. **输入层**：接收28×28×1的灰度图像数据

2. **第一个卷积层**：
   - 16个5×5的卷积核
   - ReLU激活函数
   - 池化层：2×2的最大池化

3. **第二个卷积层**：
   - 20个5×5的卷积核
   - ReLU激活函数
   - 池化层：2×2的最大池化

4. **展平层**：将多维特征图转换为一维向量

5. **第一个全连接层**：
   - 50个神经元
   - ReLU激活函数

6. **输出层**：
   - 10个神经元（对应0-9共10个数字类别）
   - Softmax激活函数（用于多分类问题）

## 四、数据预处理

实验中对数据进行了以下预处理步骤：

1. **数据加载**：使用自定义的`load_mnist`函数从本地加载gzip压缩的idx文件
2. **维度转换**：将28×28的二维图像转换为28×28×1的四维张量（适应Keras模型输入要求）
3. **数据归一化**：使用与原始PyTorch代码相同的均值(0.1307)和标准差(0.3081)进行归一化，将像素值转换为[-1,1]范围内的数值
4. **标签处理**：将整数标签转换为one-hot编码格式，用于多分类问题
5. **数据可视化**：随机显示12张训练图像及其对应的标签，直观展示数据集内容

## 五、训练过程

### 5.1 超参数设置
- 批次大小（batch_size）：64
- 学习率（learning_rate）：0.01
- 动量（momentum）：0.5
- 训练轮数（EPOCH）：10

### 5.2 优化器与损失函数
- 优化器：随机梯度下降（SGD），带有动量
- 损失函数：分类交叉熵（categorical_crossentropy）
- 评估指标：准确率（accuracy）

### 5.3 训练执行
使用Keras的`fit`方法进行模型训练，训练过程中同时在测试集上进行验证，记录训练过程中的准确率和损失值变化。

## 六、实验结果与分析

### 6.1 模型性能
模型在测试集上的准确率约为98%左右（具体数值会因随机初始化等因素略有差异），表明构建的卷积神经网络能够有效地识别手写数字。

### 6.2 准确率和损失曲线分析

通过绘制训练过程中的准确率和损失曲线，可以观察到以下特点：

1. **准确率曲线**：
   - 训练准确率随着训练轮数的增加而稳步提升
   - 测试准确率与训练准确率较为接近，没有出现明显的过拟合现象
   - 经过10轮训练后，准确率基本趋于稳定

2. **损失曲线**：
   - 训练损失随着训练轮数的增加而持续下降
   - 测试损失与训练损失的变化趋势基本一致
   - 损失值的下降速度在后期逐渐放缓，表明模型正在收敛

### 6.3 结果可视化
实验中通过matplotlib库实现了以下可视化内容：
- 数据集样本图像展示
- 训练和测试准确率对比曲线
- 训练和测试损失对比曲线

## 七、结论与体会

### 7.1 实验结论
1. 构建的卷积神经网络模型在MNIST数据集上取得了约98%的测试准确率，证明了模型的有效性
2. 卷积神经网络通过局部连接、权值共享和池化操作，能够有效地提取图像的特征信息
3. 使用动量的随机梯度下降优化器能够加速模型的收敛过程
4. Keras框架提供了简洁而强大的API，使得神经网络模型的构建和训练变得简单高效

### 7.2 实验体会
1. 数据预处理是深度学习任务中的重要环节，合理的预处理能够提高模型的训练效果
2. 网络架构的设计需要根据具体任务进行调整，不同的层数和参数设置会对结果产生影响
3. 超参数的选择对模型性能有显著影响，需要根据实验结果进行调试和优化
4. 可视化工具能够帮助我们直观地理解数据和模型的训练过程，对实验分析非常有帮助

通过本次实验，我们不仅掌握了使用Keras构建卷积神经网络的方法，还深入理解了深度学习中数据处理、模型构建、训练优化等关键环节的工作原理和实践技巧。